<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BlueZero (BØ): Connecting remote nodes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BlueZero (BØ)
   </div>
   <div id="projectbrief">Middleware for distributed applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Connecting remote nodes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>When distributing nodes across multiple machines, you must make sure that:</p><ul>
<li>nodes know how to reach the resolver node;</li>
<li>all nodes are able to reach each other, using IP and TCP protocol.</li>
</ul>
<h1><a class="anchor" id="reaching_resolver"></a>
Reaching the resolver node</h1>
<p>Nodes by default will try to reach resolver at tcp://localhost:22000, which only works when testing all nodes on the same machine. When the resolver node is on another machine, (for example the machine hostname is resolver-node-host.local) the environment variable B0_RESOLVER must be set to the correct address, e.g.:</p>
<div class="fragment"><div class="line">export B0_RESOLVER=<span class="stringliteral">&quot;tcp://resolver-node-host.local:22000&quot;</span></div></div><!-- fragment --><p>prior to launching every node, or in .bashrc or similar.</p>
<p>When B0_RESOLVER is not specified it defaults to "tcp://localhost:22000".</p>
<h1><a class="anchor" id="reaching_nodes"></a>
Reaching every other node</h1>
<p>Nodes also need to be able to reach each other node. When a node creates a directly addressed socket, such as <a class="el" href="classb0_1_1_service_client.html" title="The service client class. ">b0::ServiceClient</a> or <a class="el" href="classb0_1_1_service_server.html" title="The service server class. ">b0::ServiceServer</a>, it will advertise that socket name and address to resolver.</p>
<p>Since there is no reliable way of automatically determining the correct IP address of the node (as there may be more than one), by default the node will use its hostname when specifying the socket TCP address.</p>
<p>This requires that all machines are able to reach each other by their hostnames. This is the case when there is a name resolution service behind, such as a DNS, or Avahi/ZeroConf/Bonjour.</p>
<p>Suppose we have a network with two machines: A and B. Machine A hostname is alice.local, and machine B hostname is bob.local.</p>
<p>If from machine A we are able to reach (ping) machine B by using its hostname bob.local, and vice-versa, from machine B we are able to reach machine A by using its hostname alice.local, there is no additional configuration to set. Otherwise, we need to explicitly tell how a machine is reached from outside (i.e. what's the correct IP or hostname), by setting the B0_HOST_ID environment variable, e.g.:</p>
<div class="fragment"><div class="line">export B0_HOST_ID=<span class="stringliteral">&quot;192.168.1.3&quot;</span></div></div><!-- fragment --><p>When B0_HOST_ID is not specified it defaults to the machine hostname.</p>
<h1><a class="anchor" id="remote_nodes_example"></a>
Example</h1>
<p>Suppose we have a network with two machines: A and B.</p>
<ul>
<li>Machine A (192.168.1.5) will run the resolver node and a subscriber node.</li>
<li>Machine B (192.168.1.6) will run a publisher node.</li>
</ul>
<p>By default, nodes will use their hostnames when announcing socket addresses. We override this behavior, by setting B0_HOST_ID to the machine IP address.</p>
<h2><a class="anchor" id="remote_nodes_example_a_resolver"></a>
Machine A - starting resolver</h2>
<p>On machine A we run</p>
<div class="fragment"><div class="line">export B0_HOST_ID=<span class="stringliteral">&quot;192.168.1.5&quot;</span></div><div class="line"></div><div class="line">./resolver</div></div><!-- fragment --><p>to run the resolver node.</p>
<h2><a class="anchor" id="remote_nodes_example_a_subscriber"></a>
Machine A - starting subscriber</h2>
<p>On machine A we run</p>
<div class="fragment"><div class="line">export B0_HOST_ID=<span class="stringliteral">&quot;192.168.1.5&quot;</span></div><div class="line"></div><div class="line">./examples/publisher_subscriber/subscriber_node</div></div><!-- fragment --><p>to run the subscriber node.</p>
<p>Note that for this machine we don't need to specify B0_RESOLVER, because the default value (tcp://localhost:22000) is good to reach the resolver socket.</p>
<h2><a class="anchor" id="remote_nodes_example_b_publisher"></a>
Machine B - starting publisher</h2>
<p>On machine B we run</p>
<div class="fragment"><div class="line">export B0_HOST_ID=<span class="stringliteral">&quot;192.168.1.6&quot;</span></div><div class="line"></div><div class="line">export B0_RESOLVER=<span class="stringliteral">&quot;tcp://192.168.1.5:22000&quot;</span></div><div class="line"></div><div class="line">./examples/publisher_subscriber/publisher_node</div></div><!-- fragment --><p>to run the publisher node. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
